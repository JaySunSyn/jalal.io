<link rel="import" href="../../bower_components/polymer/polymer.html">

<link rel="import" href="../../bower_components/paper-input/paper-textarea.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/paper-spinner/paper-spinner.html">
<link rel="import" href="../../bower_components/paper-toast/paper-toast.html">
<link rel="import" href="../../bower_components/paper-checkbox/paper-checkbox.html">

<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../bower_components/iron-iconset/iron-iconset.html">
<link rel="import" href="../../bower_components/iron-iconset-svg/iron-iconset-svg.html">

<link rel="import" href="../service-email/service-email.html">


<dom-module id="page-landing" is="dom-bind">
  <style is="custom-style">

  	iron-icon:hover {
      background: white;
      border-radius:30px;
      
    }

    .big-icon{
    	height: 8%;
    	width: 8%;
    	max-height: 100px;
    	min-height: 24px;
        max-width: 100px;
        min-width: 24px;
    }

    .imageRight{
        float:right;
        display: relative;
    }

    .rTableCell .big-icon{
    	min-width: 80px;
    	height: 100%;
    	width: 100%;
    }

    .medium-icon{
    	height: 4%;
    	width: 4%;
    	max-width: 50px;
    	min-width: 25px;
    	left: 2%;
    }

    .icon-title{
    	color: var(--dark-primary-color);
    	font-size: 20px;
    	font-weight: 300;
    }

    .turn{
    	-webkit-transform: rotate(90deg);
	    -moz-transform: rotate(90deg);
	    -o-transform: rotate(90deg);
	    -ms-transform: rotate(90deg);
	    transform: rotate(90deg);
    }

    .rTable 
    { 
    	display: block;   	
    	width: 100%; 
    } 

    .rTableHeading, .rTableBody, .rTableFoot, .rTableRow
    {   	
    	clear: both; 
    }

    .rTableRow{
    	padding-bottom: 8%;
    }

    .rTableCell, .rTableHead 
    {   	
    	float: left;   	
    	height: 10%;   	
    	overflow: hidden;   	
    	padding: 3px 1.8%;   	
    	width: 28%; 
    	text-align: center;
    } 
    .rTable:after {
    	visibility: hidden;   	
    	display: block;   	
    	font-size: 0;   	
    	content: " ";   	
    	clear: both;   	
    	height: 0; 
    }

    .messageBoxFixed paper-input{
    	width: 16%;
    	min-width: 260px;
    }

    paper-textarea{
    	--paper-input-container:{
	    	width: 80%;
	    	min-width: 260px;
	    };
    }
    

    .messageBoxFixed{
    	opacity: 1;
    	display: none;
    	position: fixed;
    	padding: 48px;
    	padding-top: 12px;
        padding-bottom: 12px;
    	left: 256px;
    	background-color: lightblue;
    	width: calc(100% - 256px);
    	z-index: 100;
    	top: 64px;
    	box-shadow: 0 4px 5px 0 rgba(0,0,0,.14), 0 2px 9px 1px rgba(0,0,0,.12), 0 4px 2px -2px rgba(0,0,0,.2);
    }

    .cb{
    }

    .cbText{
        padding-top: 6px;
    }

    #toast{
        right: 10px; 
        left: auto;
        z-index: 100;
    }


    @media(max-width: 600px){
        .messageBoxFixed{
            top: 46px;
            left: 0;
            width: 100%;
        }
    }

    @media(max-width: 450px){
        .messageBoxFixed{
            position: relative;
        }

        .imageRight{
            display: none;
        }
    }

  </style>

  <template>

    <img class="imageRight" src="../../images/pics/balloonGirl.png" height="180px;">

    <!-- <h1 class="page-title"></h1> -->

    <div class="page-content">
    	
    

    	<div class="rTable"> 

    	<!-- ROW 1 -->

    	  <div class="rTableRow">
	    		<div class="rTableCell"></div>
		    	<div class="rTableCell page-title">What is your idea or product about?</div>
		    	<div class="rTableCell"></div>
    		</div> 

    		<div class="rTableRow">

	    		<div class="rTableCell">
	    			<iron-icon on-tap="ic_tapped" id="mobile"
				    	src="../../bower_components/material-design-icons/hardware/svg/production/ic_phone_iphone_48px.svg" 
				    	class="big-icon"
				    ></iron-icon>
	    		</div> 
	    		<div class="rTableCell">
	    			<iron-icon on-tap="ic_tapped" id="web"
				    	src="../../bower_components/material-design-icons/hardware/svg/production/ic_laptop_mac_48px.svg" 
				    	class="big-icon"
				    ></iron-icon>
	    		</div> 
	    		<div class="rTableCell">
	    			<iron-icon on-tap="ic_tapped" id="hardware"
				    	src="../../bower_components/material-design-icons/hardware/svg/production/ic_watch_48px.svg" 
				    	class="big-icon"
				    ></iron-icon>
	    		</div>
    		</div> 

    		<div class="rTableRow"> 
	    		<div class="rTableCell"><paper-checkbox class="cb row_1" row="row_1" id="cb_mobile" on-iron-change="cb_changed"></paper-checkbox><div class="cbText">Mobile</div></div> 
	    		<div class="rTableCell"><paper-checkbox class="cb row_1" row="row_1" id="cb_web" on-iron-change="cb_changed"></paper-checkbox><div class="cbText">Web</div></div>
	    		<div class="rTableCell"><paper-checkbox class="cb row_1" row="row_1" id="cb_hardware" on-iron-change="cb_changed"></paper-checkbox><div class="cbText">Hardware</div></div> 
    		</div>
    		

    	<!-- ROW 2 -->

    	  <div class="rTableRow">
	    		<div class="rTableCell"></div>
		    	<div class="rTableCell page-title">In which stage are you?</div>
		    	<div class="rTableCell"></div>
    		</div> 

    		<div class="rTableRow">

	    		<div class="rTableCell">
	    			<iron-icon on-tap="ic_tapped" id="idea"
				    	src="../../bower_components/material-design-icons/image/svg/production/ic_wb_incandescent_48px.svg" 
				    	class="big-icon"
				    ></iron-icon>
	    		</div> 
	    		<div class="rTableCell">
	    			<iron-icon on-tap="ic_tapped" id="development"
				    	src="../../bower_components/material-design-icons/content/svg/production/ic_gesture_48px.svg" 
				    	class="big-icon"
				    ></iron-icon>
	    		</div> 
	    		<div class="rTableCell">
	    			<iron-icon on-tap="ic_tapped" id="market"
				    	src="../../bower_components/material-design-icons/action/svg/production/ic_trending_up_48px.svg" 
				    	class="big-icon"
				    ></iron-icon>
	    		</div>
    		</div> 
    		<div class="rTableRow"> 
	    		<div class="rTableCell"><paper-checkbox class="cb row_2" row="row_2" id="cb_idea" on-iron-change="cb_changed"></paper-checkbox><div class="cbText">Idea Stage</div></div> 
	    		<div class="rTableCell"><paper-checkbox class="cb row_2" row="row_2" id="cb_development" on-iron-change="cb_changed"></paper-checkbox><div class="cbText">In Production</div></div>
	    		<div class="rTableCell"><paper-checkbox class="cb row_2" row="row_2" id="cb_market" on-iron-change="cb_changed"></paper-checkbox><div class="cbText">Already out there</div></div> 
    		</div>

    	<!-- ROW 3 -->

    	  <div class="rTableRow">
	    		<div class="rTableCell"></div>
		    	<div class="rTableCell page-title">What do you need?</div>
		    	<div class="rTableCell"></div>
    		</div> 

    		<div class="rTableRow">

	    		<div class="rTableCell">
	    			<iron-icon on-tap="ic_tapped" id="concept"
				    	src="../../bower_components/material-design-icons/action/svg/production/ic_group_work_48px.svg" 
				    	class="big-icon"
				    ></iron-icon>
	    		</div> 
	    		<div class="rTableCell">
	    			<iron-icon on-tap="ic_tapped" id="power"
				    	src="../../bower_components/material-design-icons/social/svg/production/ic_people_48px.svg" 
				    	class="big-icon"
				    ></iron-icon>
	    		</div> 
	    		<div class="rTableCell">
	    			<iron-icon on-tap="ic_tapped" id="talk"
				    	src="../../bower_components/material-design-icons/action/svg/production/ic_face_48px.svg" 
				    	class="big-icon"
				    ></iron-icon>
	    		</div>
    		</div> 
    		<div class="rTableRow"> 
	    		<div class="rTableCell"><paper-checkbox class="cb row_3" row="row_3" id="cb_concept" on-iron-change="cb_changed"></paper-checkbox><div class="cbText">Technical feasibility</div></div> 
	    		<div class="rTableCell"><paper-checkbox class="cb row_3" row="row_3" id="cb_power" on-iron-change="cb_changed"></paper-checkbox><div class="cbText">Development power</div></div>
	    		<div class="rTableCell"><paper-checkbox class="cb row_3" row="row_3" id="cb_talk" on-iron-change="cb_changed"></paper-checkbox><div class="cbText">I just want to talk</div></div> 
    		</div>

    	</div>

        <!-- message box -->
        <div class="messageBoxFixed" id="messageBox">
            <paper-textarea id="messageBoxText" value="{{msgTxt}}"></paper-textarea>
            <span>
                <paper-input id="messageBoxEmail" value="{{emailFrom}}" placeholder="Your Email"></paper-input>
                <paper-button on-tap="sendTapped" raised>Send</paper-button>
                <paper-spinner id="sendSpinner"></paper-spinner>
            </span>
        </div>

    </div>

    <paper-toast id="toast"></paper-toast>
    <service-email id="serviceEmail" message="[[msgTxt]]" from="[[emailFrom]]" 
        on-sent="emailSent"
        on-error="emailError"></service-email>

  </template>

  <script>
      Polymer({

        is: 'page-landing',

        properties:{

        	msgBoxVisible:Boolean,

        	msgGreeting:{
        		type:String,
        		value:'Hi Jalal,'
        	},

        	msgTxt:{
	        	type:String,
	        	computed:'_computeMsg(msgGreeting, msg_p1, msg_p2, msg_p3)'
	        },

	        msg_p1:{
	        	type:String,
	        	value:'',
	        	notify:true
	        },
	        msg_p2:{
	        	type:String,
	        	value:'',
	        	notify:true
	        },
	        msg_p3:{
	        	type:String,
	        	value:'',
	        	notify:true
	        }

        },

        _computeMsg:function(msgGreeting, msg_p1, msg_p2, msg_p3){
        	return msgGreeting + ' ' + msg_p1 + '' + msg_p2 + '' + msg_p3;
        },

        scrollChanged:function(topPosition){

            // fade/unfade message box at scroll position
        	if (topPosition<40) {
        		if (this.msgBoxVisible) {
        			this.fade(this.$.messageBox);
        			this.msgBoxVisible=false;
        		};
        		
        	} else{
        		if (!this.msgBoxVisible) {
        			this.unfade(this.$.messageBox);
        			this.msgBoxVisible=true;
        		};
        	};

            // make it less transparent with scroll activity
            op = parseFloat(this.$.messageBox.style.opacity);
            op += parseFloat(topPosition) * 0.000005;

            this.$.messageBox.style.opacity = op;
            this.$.messageBox.style.filter = 'alpha(opacity=' + op * 100 + ")";

        },

        ic_tapped:function(e){
        	var cb = document.getElementById('cb_' + e.target.parentElement.id);

        	if (cb) {
        		cb.checked=true;
        	};
        	
        },

        uncheckAll:function(className,except){

        	var rowElements = document.getElementsByClassName(className);

        	for (var i = rowElements.length - 1; i >= 0; i--) {
        		if (rowElements[i] != except) {
        			rowElements[i].checked = false;
        		};	
        	};

        },

        cb_changed:function(e){
        	if (e.target.checked) {

                this.$.messageBox.hidden=false;

	        	switch(e.target.id){
                    // 1
	        		case 'cb_mobile':
	        			this.msg_p1 = 'I have a mobile product/idea I want to talk with you about!';
	        			break;

	        		case 'cb_web':
	        			this.msg_p1 = 'I have a web product/idea I want to talk with you about!';
	        			break;

	        		case 'cb_hardware':
	        			this.msg_p1 = 'I have a hardware product/idea I want to talk with you about!';
	        			break;
                    // 2
                    case 'cb_idea':
                        this.msg_p2 = ' It is currently in the idea stage';
                        break;

                    case 'cb_development':
                        this.msg_p2 = ' The development has already started';
                        break;

                    case 'cb_market':
                        this.msg_p2 = ' It is already out in the market';
                        break;
                    // 3
                    case 'cb_concept':
                        this.msg_p3 = ' and I want to know if and how it is technical realizable.';
                        break;

                    case 'cb_power':
                        this.msg_p3 = ' and I would need some additional development power.';
                        break;

                    case 'cb_talk':
                        this.msg_p3 = ' and I would like to ask you some questions about it.';
                        break;
	        	}

	        	this.uncheckAll(e.target.getAttribute('row'),e.target);	
        		
        	};

        },

        sendTapped:function(){
            this.$.sendSpinner.active = true;
            this.$.serviceEmail.sendMail();
        },

        emailError:function(event,response){
            this.$.sendSpinner.active = false;
            this.$.toast.text = response.status;
            this.$.toast.show();
        },

        emailSent:function(event,response){
            this.$.sendSpinner.active = false;
            if (response.status == 'rejected') {
                this.$.toast.text = response.reject_reason;
            }else{
                this.$.toast.text = response.status;
            };
            
            this.$.toast.show();

            if (response.status == 'sent') {
                this.$.messageBox.hidden=true;
            };
            
        },

        fade:function(element) {
			    var op = 1;  // initial opacity
			    var timer = setInterval(function () {
			        if (op <= 0.1){
			            clearInterval(timer);
			            element.style.display = 'none';
			        }
			        element.style.opacity = op;
			        element.style.filter = 'alpha(opacity=' + op * 100 + ")";
			        op -= op * 0.1;
			    }, 10);
				},

		unfade:function(element) {
	    var op = 0.1;  // initial opacity
	    element.style.display = 'block';
	    var timer = setInterval(function () {
	        if (op >= 0.7){
	            clearInterval(timer);
	        }
	        element.style.opacity = op;
	        element.style.filter = 'alpha(opacity=' + op * 100 + ")";
	        op += op * 0.1;
	    }, 10);
		}


      });

  </script>

</dom-module>
